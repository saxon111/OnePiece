{"version":3,"file":"vue.js","sources":["../src/observe/array.js","../src/observe/index.js","../src/state.js","../src/compiler/parse.js","../src/compiler/generate.js","../src/compiler/index.js","../src/init.js","../src/index.js"],"sourcesContent":["let oldArrayProtoMethods = Array.prototype;\n\n// 不能直接改写数组原有方法 不可靠，因为只有被vue控制的数组才需要改写\n\nexport let arrayMethods = Object.create(Array.prototype);\n\nlet methods = [\n  // concat slice ... 都不能改变原数组\n  \"push\",\n  \"pop\",\n  \"shift\",\n  \"unshift\",\n  \"splice\",\n  \"reverse\",\n  \"sort\",\n];\n\nmethods.forEach((method) => {\n  // AOP 切片编程\n  arrayMethods[method] = function (...args) {\n    // todo...\n    console.log(\"数组变化\");\n\n    // 有可能用户新增的数据时对象格式 也需要进行拦截\n    let result = oldArrayProtoMethods[method].call(this, ...args);\n    let inserted;\n    let ob = this.__ob__;\n    switch (method) {\n      case \"push\":\n      case \"unshift\":\n        inserted = args;\n        break;\n      case \"splice\": // splice(0,1,xxxx)\n        inserted = args.slice(2);\n      default:\n        break;\n    }\n    if (inserted) ob.observeArray(inserted);\n    return result;\n  };\n});\n","import { arrayMethods } from \"./array\";\n\nclass Observer {\n  constructor(value) {\n    //需要对这个value属性重新定义\n\n    // value可能是对象 可能是数组，分类来处理；\n    // value.__ob__ = this;\n    Object.defineProperty(value, \"__ob__\", {\n      value: this,\n      enumerable: false, // 不能被枚举表示 不能被循环\n      configurable: false, // 不能删除此属性\n    });\n    if (Array.isArray(value)) {\n      //数组不用defineProperty\n      // value.__proto__ = arrayMethods\n      // push shift reverse sort  我要重写这些方法增加更新逻辑\n      Object.setPrototypeOf(value, arrayMethods); // 循环将属性赋予上去\n      this.observeArray(value); // 原有数组中的对象  Object.freeze()\n    } else {\n      this.walk(value);\n    }\n  }\n  observeArray(value) {\n    for (let i = 0; i < value.length; i++) {\n      observe(value[i]);\n    }\n  }\n  walk(data) {\n    // 将对象中的所有key，重新用defineProperty定义成响应式的\n    Object.keys(data).forEach((key) => {\n      defineReactive(data, key, data[key]);\n    });\n  }\n}\n\nfunction defineReactive(data, key, value) {\n  // vue2中数据嵌套不要过深 过深浪费性能\n\n  observe(value); // 对结果递归拦截\n  Object.defineProperty(data, key, {\n    get() {\n      console.log(\"get\");\n      return value;\n    },\n    set(newValue) {\n      console.log(\"set\");\n      if (newValue === value) return;\n      observe(newValue); // 如果用户设置的是一个对象 ， 就继续将用户设置的对象变成响应式的\n      value = newValue;\n    },\n  });\n}\n\nexport function observe(data) {\n  // 只对对象类型进行观测，非对象类型无法观测\n  if (typeof data !== \"object\" || data === null) {\n    return;\n  }\n  if (data.__ob__) {\n    // 放置循环引用了\n    return;\n  }\n  // 通过类来实现对数据的观测 类可以方便扩展， 会产生实例\n  console.log(data, \"-------------\");\n  return new Observer(data);\n}\n","import { observe } from \"./observe/index\"\n\nexport function initState(vm) {\n    //将所有属性都定义在vm属性上，并且后续更改需要触发视图更新\n    const opts = vm.$options\n\n    if (opts.data) { //数据初始化\n        initData(vm)\n    }\n    // if (opts.method) {\n\n    // }\n    // if (opts.props) {\n\n    // }\n    // if (opts.computed) {\n\n    // }\n    // if (opts.watch) {\n        \n    // }\n}\n\nfunction proxy(vm, source, key) {\n    Object.defineProperty(vm, key, {\n        get() {\n            return vm[source][key]\n        },\n        set(newVal) {\n            vm[source][key] = newVal\n        }\n    })\n}\nfunction initData(vm) {\n    // 数据劫持  Object.defineProperty\n    console.log(vm)\n    let data = vm.$options.data\n    // 对data类型进行判断 如果是函数 获取函数返回值作为对象\n    data = vm._data = typeof data === 'function' ? data.call(vm) : data\n\n\n     // 通过vm._data 获取劫持后的数据，用户就可以拿到_data了\n    // 将_data中的数据全部放到vm上\n\n    for (let key in data) {\n        proxy(vm, '_data', key) //vm.name => vm._data.name\n    }\n    //观测这个数据\n    observe(data)\n}","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // aa-aa\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; //aa:aa\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 可以匹配到标签名  [1]\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); //[0] 标签的结束名字\n//    style=\"xxx\"   style='xxx'  style=xxx\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;\nconst startTagClose = /^\\s*(\\/?)>/;\n\nexport function parseHTML(html) {\n  function createASTElement(tag, attrs) {\n    //vue3里面支持多个根元素(外层加了一个空元素)，vue2中只有一个根节点\n    return {\n      tag,\n      type: 1,\n      children: [],\n      attrs,\n      parent: null,\n    };\n  }\n  let root = null;\n  let currentParent;\n  let stack = [];\n  // 根据开始标签 结束标签 文本内容 生成ast语法树\n  function start(tagName, attrs) {\n    let element = createASTElement(tagName, attrs);\n    if (!root) {\n      root = element;\n    }\n    currentParent = element;\n    stack.push(element);\n    console.log(\"start--------->\", tagName);\n  }\n\n  function end(tagName) {\n    let element = stack.pop();\n    currentParent = stack[stack.length - 1];\n    if (currentParent) {\n      element.parent = currentParent;\n      currentParent.children.push(element);\n    }\n    console.log(\"end--------->\", tagName);\n  }\n\n  function chars(text) {\n    text = text.replace(/\\s/g, '');\n    if (text) {\n      currentParent.children.push({\n        type: 3,\n        text,\n      });\n    }\n    console.log(\"text--------->\", text);\n  }\n  function advance(n) {\n    html = html.substring(n);\n  }\n  function parseStartTag() {\n    const start = html.match(startTagOpen);\n    if (start) {\n      let match = {\n        tagName: start[1],\n        attrs: [],\n      };\n      advance(start[0].length); //获取元素\n      // 查找属性\n      let end;\n      let attr;\n      // 不是开头标签结尾就一直解析\n      while (\n        !(end = html.match(startTagClose)) &&\n        (attr = html.match(attribute))\n      ) {\n        advance(attr[0].length);\n        console.log(attr)\n        match.attrs.push({\n          name: attr[1],\n          value: attr[3] || attr[4] || attr[5] || true,\n        });\n        console.log(match,attr[1],attr[3])\n      }\n      if (end) {\n        advance(end[0].length);\n        return match;\n      }\n    }\n  }\n  while (html) {\n    let textEnd = html.indexOf(\"<\");\n    if (textEnd === 0) {\n      let startTagMatch = parseStartTag();\n      if (startTagMatch) {\n        start(startTagMatch.tagName, startTagMatch.attrs);\n        //开始标签\n        // console.log(\"开始\", startTagMatch.tagName);\n        continue;\n      }\n      //结束标签\n      let endTagMatch = html.match(endTag);\n      if (endTagMatch) {\n        advance(endTagMatch[0].length);\n        end(endTagMatch[1]);\n        continue;\n      }\n      // continue\n      // console.log(startTagMatch);\n    }\n    let text;\n\n    if (textEnd > 0) {\n      // debugger\n      //开始解析文本\n      text = html.substring(0, textEnd);\n    }\n    if (text) {\n      advance(text.length);\n      chars(text);\n      // console.log(\"wenben\", html);\n    }\n  }\n  return root\n}\n\n// ast语法树\n","const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g\nfunction genProps(attrs) {\n    let str = '';\n    for (let i = 0; i < attrs.length; i++) {\n        let attr = attrs[i]; // name,value\n        if (attr.name === 'style') {\n            let obj = {};\n            attr.value.split(';').forEach(item => {\n                let [key, value] = item.split(':');\n                obj[key] = value\n            });\n            attr.value = obj; // {style:{color:red}}\n        }\n        str += `${attr.name}:${JSON.stringify(attr.value)},` // {a:'aaa',a:1,b:2,}\n    }\n    return `{${str.slice(0,-1)}}`;\n}\n\nfunction genChildren(el) {\n    const children  = el.children;\n    if(children){\n        return children.map(child=>gen(child)).join(',')\n    }\n}\nfunction gen(node){ // 区分是元素 还是文本\n    if(node.type == 1){\n        return generate(node);\n    }else{\n        //文本 逻辑不能用 _c来处理\n        // 有{{}} 普通文本  混合文本 {{aa}} aaa {{bbb}} ccc\n        let text =  node.text;\n        if(defaultTagRE.test(text)){ // _v(_s(name) + 'aa' + _s(age) + '哈哈'）\n            let tokens = [];\n            let match ;\n            let index = 0;\n            let lastIndex = defaultTagRE.lastIndex = 0;\n            while(match = defaultTagRE.exec(text)){ // aa {{ age }} haha \n                index = match.index;\n                if(index >lastIndex){\n                    tokens.push(JSON.stringify(text.slice(lastIndex,index)));\n                }\n                tokens.push(`_s(${match[1].trim()})`);\n                lastIndex = index + match[0].length;\n            }\n            if(lastIndex < text.length){\n                tokens.push(JSON.stringify(text.slice(lastIndex)))\n            }\n            return  `_v(${tokens.join('+')})`\n\n            // 是带有{{}}\n        }else{\n            return `_v(${JSON.stringify(text)})`\n        }\n    }\n}\nexport function generate(el) {\n    // console.log(el); // 转换成render代码\n    let children = genChildren(el);\n    let code = `_c('${el.tag}',${\n        el.attrs.length? genProps(el.attrs):'undefined'\n    } ${\n        children? (',' + children) : ''\n    })`;\n    // => js代码 html=> js代码  字符串拼接\n    return code;\n}\n\n\n/* \n<div id=\"app\" a=1 b=2>\n    <span style\"=color:red\">{{name}} <a>hello</a></span>\n</div> \n _c(\n    'div',{id:'app',a:1,b:2}\n    ,_c(\n        'span',\n        {style:{color:'red'}}\n        ,_s(_v(name)),\n        _c(a,undefined,_v('hello'))\n        )\n)\n*/","import { parseHTML } from \"./parse\";\nimport { generate } from \"./generate\";\n\nexport function compileToFunctions(template) {\n    let ast = parseHTML(template);\n    console.log(ast);\n    let code = generate(ast); //生成代码\n    console.log(code)\n  }\n  ","import { initState } from \"./state\";\nimport { compileToFunctions } from \"./compiler/index\";\n\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n      const vm = this\n      vm.$options = options\n      console.log(options)\n      // 初始化状态\n      initState(vm)\n\n      if(vm.$options.el) { // 数据可以挂载到页面上\n        vm.$mount(vm.$options.el)\n      }\n  };\n  Vue.prototype.$mount = function(el) {\n      el = document.querySelector(el)\n      const vm = this;\n      const options = vm.$options\n      \n      // 如果有render 就直接使用render\n      // 没有render 看有没有template属性\n      // 没有template，就接着找外部模板\n      if (!options.render) {\n        let template = options.template;\n        if (!template && el) {\n            template = el.outerHTML // 火狐不兼容 document.createElement('div').appendChild('app').innerHTML\n        }\n        // 如何将模板编译成render 函数\n        const render = compileToFunctions(template)\n        options.render = render\n      }\n  }\n}\n\n\n","// Vue2.0 中就是一个构造函数\nimport { initMixin } from \"./init\"\nfunction Vue(options) {\n  console.log(options);\n  this._init(options) // 当用户new Vue时 就调用init方法进行vue的初始方法\n}\n\n// 可以拆分逻辑到不同文件中 更有利于维护\ninitMixin(Vue)\n\nexport default Vue;\n"],"names":["oldArrayProtoMethods","Array","prototype","arrayMethods","Object","create","methods","forEach","method","console","log","args","result","call","inserted","ob","__ob__","slice","observeArray","Observer","value","defineProperty","enumerable","configurable","isArray","setPrototypeOf","walk","i","length","observe","data","keys","key","defineReactive","get","set","newValue","initState","vm","opts","$options","initData","proxy","source","newVal","_data","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","parseHTML","html","createASTElement","tag","attrs","type","children","parent","root","currentParent","stack","start","tagName","element","push","end","pop","chars","text","replace","advance","n","substring","parseStartTag","match","attr","name","textEnd","indexOf","startTagMatch","endTagMatch","defaultTagRE","genProps","str","obj","split","item","JSON","stringify","genChildren","el","map","child","gen","join","node","generate","test","tokens","index","lastIndex","exec","trim","code","compileToFunctions","template","ast","initMixin","Vue","_init","options","$mount","document","querySelector","render","outerHTML"],"mappings":"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"}